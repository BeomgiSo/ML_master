# Clustering 군집화

## 1. K-means clustering
- K Means clustering algorithm은 가장 일반적으로 사용되는 알고리즘
- 군집 중심(centroid)이라는 특정한 임의의 지점을 선택해 해당 중심에 가장 가까운 포인트를 선택하여 군집화 하는 기법
- 군집 중심점은 선택된 포인트의 평균 지점으로 이동하고 이동된 중심점에서 다시 가까운 포인트를 선택, 다시 중심점을 평균 지점으로 이동하는 프로세스를 반복적으로 수행
- 모든 데이터 포인트에서 더이상 중심점의 이동이 없을 경우 반복을 멈추고 해당 중심점에 속하는 데이터 포인트들을 군집화하는 기법

--- 
### 예시
    1. 2개의 군집 중심점 설정
        - 군집화 개수 만큼 임의의 위치에 가져다 놓는다.
        - 임의의 위치로 설정시 반복적인 이동 수행을 너무 많이 해서 수행시간이 오리 걸리는 문제 발생
        - 이를 극복하기 위해 초기화 알고리즘으로 적합한 위치에 중심정으로 가져다 놓기도 한다.

    2. 각 데이터는 가장 가까운 중심점에 소속

    3. 중심점에 할당된 데이터들의 평균 중심으로 중심점 이동
        - 소속이 결정되면 군집 중심점을 소속된 데이터의 평균 중심으로 이동

    4. 각 데이터는 이동된 중심점 기준으로 가장 가까운 중심점에 소속
        - 중심정이 이동했기 떄문에, 각 데이터는 기존에 속한 중심점보다 더 가까운 중심점이 있다면, 해당 중심적으로 다시 소속을 변경

    5. 다시 중심점에 할당된 데이터들의 평균 중심으로 중심점 이동
    
    6. 중심점을 이동해도, 데이터들의 줌심점 소속 변경이 없으면 군집화 완료
---


### K-means clustering의 장 단점

    - 장점
        1. 일반적인 군집화에서 가장 많이 활용되는 알고리즘
        2. 알고리즘이 쉽고 간결
    - 단점
        1. 거리 기반 알고리즘으로 속성의 개수가 매우 많을경우 군집화의 정확도가 떨어진다
            - 차원축소 ex PCA를 적용하여 속성을 줄인다.
        2. 반복을 수항해는데, 반복 횟수가 많을 경우 수행 시간 소모가 매우 큼
        3. 몇개의 군집을 선택해야할지 가이드가 어렵다.

## 2. 군집평가(Cluster Evaluation)

- 군집화는 분류와 매우 유사하지만 성격이 많이 다르다.
    - 데이터 내에 숨어 있는 별도의 그룹을 찾아서 의미를 부여 혹은 동리한 분류값에 속하더라도 그 안에서 더 세분화된 군집화를 추구하거나 서로 다른 분류값의 데이터도 더 넓은 군집화 레벨화 등의 영역을 가짐

- 비지도 학습의 특성산 어떠한 지표라도 정확하게 성능을 평가하기 어렵다.
- 군집화의 성능을 평가하는 대표적은 방법으로 실루엣 분석을 사용


### Introduction Silhouette analysis

- 실루엣 분석은 각 군집 간의 거리가 얼마나 효율적으로 분리돼 있는지 나타냄
- 효율적으로 잘 분리됐다는 것은 다른 군집과의 거리가 떨어져 있고, 동일 군집끼리의 데이터는 서로 가깝게 잘 뭉쳐있다는 의미
- 군집화가 잘 될수록 개별 군집은 비슷한 정도의 여유공간을 가지고 떨어져 있음

- 실루엣 분석은 실루엣 계수(Sillhouette coefficient)를 기반으로 진행
- 실루엣 계수는 개별 데이터가 가지는 군집화 지표
- 개별 데이터가 가지는 실루엣 계수는 해당 데이터가 같은 군집 내의 데이터와 얼마나 군진화 돼 있고, 다른 구집에 있는 데이터와는 얼마나 멀리 분리돼 있는지 나타내는 지표

$$S(i) = \frac{(b(i) - a(i))}{(max(a(i),b(i)))}$$

$a(i) : i 라는 포인트와 같은 군집 내에 있는 다른 데이터 포인트와의 거리를 평균한 값$

$b(i) : i 라는 포인트가 속하지 않은 군집중 가장 가까운 군집과의 평균 거리$

$S(i) : i 라는 포인트의 실루엣 계수$


- 두 집단간의 distance에서 정규화를 위해 MAX(a(i),b(i))값으로 나눠준 값
- i 번째 데이터 포인트의 실루엣 계수 값
- 실루엣 계수는 -1에서 1 값을 가지며, 1에 가까워 질수록 그너의 군집과 더 멀어져 있다는 의미이고, 0에 가까울 수록 근처의 군집과 가까워진다는 것을 의미
- 마이너스를 갖는다는것은 다른 군집에 데이터 포인트가 할당됐음을 의미한다.

### 좋은 군집화

- 전체 실루엣 계수의 평균값, 0~1 사이의 값을 가지며, 1에 가까울 수록 좋다.
- 하지만 전체 실루엣 계수의 평균값과 더불어 개별 군집의 평균값의 편차가 크지 않아야한다.
- 즉, 개별 군집의 실루엣 계수 평균값이 전체 실루엣 계수의 평균값에서 크게 벗어나지 않는것이 중요
- 만약 전체 실루엣 계수의 평균값은 높지만, 특정 군집의 실루엣 계수 평균값만 유난히 높고 다른 군집들의 실루엣 평균값만 유난히 높고 다른 군집들의 실루엣 계수 평군값은 낮으면 좋은 군집화 좋건이 아니다.

## 3. 평균이동

### 평균 이동(Mean Shift)의 개요

- ㅏ